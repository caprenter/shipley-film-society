// browserdetect.js
if(typeof(AC)==="undefined"){AC={}}AC.Detector={getAgent:function(){return navigator.userAgent.toLowerCase()},isMac:function(b){var a=b||this.getAgent();return!!a.match(/mac/i)},isWin:function(b){var a=b||this.getAgent();return!!a.match(/win/i)},isWin2k:function(b){var a=b||this.getAgent();return this.isWin(a)&&(a.match(/nt\s*5/i))},isWinVista:function(b){var a=b||this.getAgent();return this.isWin(a)&&(a.match(/nt\s*6/i))},isWebKit:function(b){if(this._isWebKit===undefined){var a=b||this.getAgent();this._isWebKit=!!a.match(/AppleWebKit/i);this.isWebKit=function(){return this._isWebKit}}return this._isWebKit},isSafari2:function(c){if(this._isSafari2===undefined){if(!this.isWebKit()){this._isSafari2=false}else{var b=navigator.userAgent.toLowerCase();var a=parseInt(parseFloat(b.substring(b.lastIndexOf("safari/")+7)),10);this._isSafari2=(a>=419)}this.isSafari2=function(){return this._isSafari2}}return this._isSafari2},isOpera:function(b){var a=b||this.getAgent();return!!a.match(/opera/i)},isIE:function(b){var a=b||this.getAgent();return!!a.match(/msie/i)},isIEStrict:function(b){var a=b||this.getAgent();return a.match(/msie/i)&&!this.isOpera(a)},isFirefox:function(b){var a=b||this.getAgent();return!!a.match(/firefox/i)},isiPhone:function(b){var a=b||this.getAgent();return this.isMobile(a)},iPhoneOSVersion:function(d){var c=d||this.getAgent(),a=this.isMobile(c),e,f,b;if(a){var e=c.match(/.*CPU ([\w|\s]+) like/i);if(e&&e[1]){f=e[1].split(" ");b=f[2].split("_");return b}else{return[1]}}else{return null}},isMobile:function(b){var a=b||this.getAgent();return this.isWebKit(a)&&a.match(/Mobile/i)},isiTunesOK:function(b){var a=b||this.getAgent();return this.isMac(a)||this.isWin2k(a)},_isQTInstalled:undefined,isQTInstalled:function(){if(this._isQTInstalled===undefined){var a=false;if(navigator.plugins&&navigator.plugins.length){for(var b=0;b<navigator.plugins.length;b++){var c=navigator.plugins[b];if(c.name.indexOf("QuickTime")>-1){a=true}}}else{if(typeof(execScript)!="undefined"){qtObj=false;execScript('on error resume next: qtObj = IsObject(CreateObject("QuickTimeCheckObject.QuickTimeCheck.1"))',"VBScript");a=qtObj}}this._isQTInstalled=a}return this._isQTInstalled},getQTVersion:function(){var a="0";if(navigator.plugins&&navigator.plugins.length){for(var c=0;c<navigator.plugins.length;c++){var d=navigator.plugins[c];var b=d.name.match(/quicktime\D*([\.\d]*)/i);if(b&&b[1]){a=b[1]}}}else{if(typeof(execScript)!="undefined"){ieQTVersion=null;execScript('on error resume next: ieQTVersion = CreateObject("QuickTimeCheckObject.QuickTimeCheck.1").QuickTimeVersion',"VBScript");if(ieQTVersion){a=ieQTVersion.toString(16);a=[a.charAt(0),a.charAt(1),a.charAt(2)].join(".")}}}return a},isQTCompatible:function(c,e){function b(g,i){var f=parseInt(g[0],10);if(isNaN(f)){f=0}var h=parseInt(i[0],10);if(isNaN(h)){h=0}if(f===h){if(g.length>1){return b(g.slice(1),i.slice(1))}else{return true}}else{if(f<h){return true}else{return false}}}var d=c.split(/\./);var a=e?e.split(/\./):this.getQTVersion().split(/\./);return b(d,a)},isValidQTAvailable:function(a){return this.isQTInstalled()&&this.isQTCompatible(a)},isFlashAvailable:function(a){return(typeof swfobject!=="undefined")?swfobject.hasFlashPlayerVersion(a):false}};
// core.js
Object.extend(Event,{_domReady:function(){if(arguments.callee.done){return}arguments.callee.done=true;if(this._timer){clearInterval(this._timer)}AC.isDomReady=true;if(this._readyCallbacks){this._readyCallbacks.each(function(a){a()})}this._readyCallbacks=null},onDOMReady:function(f){if(AC.isDomReady){f()}else{if(!this._readyCallbacks){var domReady=this._domReady.bind(this);if(document.addEventListener){document.addEventListener("DOMContentLoaded",domReady,false);}if(/WebKit/i.test(navigator.userAgent)){this._timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){domReady()}},10)}Event.observe(window,"load",domReady);Event._readyCallbacks=[]}Event._readyCallbacks.push(f)}}});if(typeof(AC)=="undefined"){AC={}}
// event_mixins.js
Event.Publisher = Class.create();
Object.extend( Event.Publisher, {
	_ls_event_targets: null,
	
	_event_source_id: null,
	
	_fl_trace_events: false,
	
	getEventSourceId: function() {
		if ( typeof this._event_source_id == 'function' )
			return this._event_source_id();
		else
			return this._event_source_id;
	},
	
	getEventTarget: function( event_name ) {
		if ( ! this._ls_event_targets )
			this._ls_event_targets = new Array();
		
		if ( ! this._ls_event_targets[ event_name ] )
			document.body.appendChild(
				this._ls_event_targets[ event_name ] = document.createElement( 'A' )
			);
		
		return this._ls_event_targets[ event_name ];
	},
	
	addEventListener: function( event_name, callback_func, capturing ) {
		var targ = this.getEventTarget( event_name );
		
		Event.observe( targ, 'click', callback_func, capturing );
		
		if ( this._fl_trace_events ) {
			var data =  {
				publisher: this.getEventSourceId(),
				event_name: event_name,
				listener: callback_func,
				capturing: capturing,
				event_source_proxy: targ
			};
			
			this.dispatchEvent( 'eventListenerAdded', data, true, true );
		}
	},
	
	removeEventListener: function( event_name, callback_func, capturing ) {
		var targ = this.getEventTarget( event_name );
		
		Event.stopObserving( targ, 'click', callback_func, capturing );
		
		if ( this._fl_trace_events ) {
			var data =  {
				publisher: this.getEventSourceId(),
				event_name: event_name,
				listener: callback_func,
				capturing: capturing,
				event_source_proxy: targ
			};
			
			this.dispatchEvent( 'eventListenerRemoved', data, true, true );
		}
	},
	
	dispatchEvent: function( event_name, data, can_bubble, cancelable ) {
		var targ = this.getEventTarget( event_name );
		var event_data = {
			event_name: event_name,
			event_target: this,
			data: data ? data : null
		};
		
		if ( ! can_bubble ) can_bubble = false;
		if ( ! cancelable ) cancelable = false;
		
		var event = Event.create( event_data, can_bubble, cancelable, true, targ );
		
		if ( this._fl_trace_events ) {
			if ( event_name.match( /event(?:ListenerAdded|ListenerRemoved|Dispatched|Received)/ ) )
				return;
			
			var data =  {
				publisher: this.getEventSourceId(),
				event_name: event_name,
				event_data: event_data,
				can_bubble: can_bubble,
				cancelable: cancelable,
				event_source_proxy: targ,
				result: event
			};
			
			this.dispatchEvent( 'eventDispatched', data, true, true );
		}
	},
	
	toggleEventsTrace: function() {
		var trace = Event.Tracer.findTracer();
		
		if ( ! trace || ! this._fl_trace_events ) {
			this._fl_trace_events = true;
			
			trace = Event.Tracer.startTrace();
			
			trace.registerPublisher( this );
		}
		else {
			this._fl_trace_events = false;
			
			if ( trace )
				trace.unregisterPublisher( this );
		}
		
		return this._fl_trace_events;
	},
	
	isEventsTraceActive: function() {
		return this._fl_trace_events;
	}
} );

/**
  *  MIX IN: Event.Listener
  *  
  *  Description:
  *    easily add support for receiving totally custom events
  *    (to any object or class) by mixing this class into
  *    your own
  *  
  *  Usage:
  *	   To receive custom events:
  *      1. mix this class with your own via
  *         Object.extend( [your class or prototype], EventListener )
  *      2. listen for events by calling (from your object)
  *         this.listen()
  *         (see params for this.listen, below)
  **/
Event.Listener = Class.create();
Object.extend( Event.Listener,
{
	_listens: null,
	
	getEventHandlerName: function( event_name ) {
		var onEvent_name = event_name.split( /[ _]/ ).join( '-' ).camelize();
		
		return "on" + onEvent_name.charAt( 0 ).toUpperCase() + onEvent_name.substr( 1 );
	},
	
	/**
	  *	 Params:
      *    event_source [object]:
      *      the object which will generate the events, and which implements (or
      *      mixes in) the Event.Publisher interface (we need addEventListener)
      *    event_name [string]:
      *      the name of the event for which your object will listen
      *    use_capture [boolean]:
      *      standard DOM Event API param
      *    onEvent_name [string]:
      *      the name of the method in your object which will be called when the
      *      event is received if you omit this param, listen will look for a
      *      function named with the CapitalizedCamelCased name of the event with
      *      "on" at the front. So, if the event is named "message_received",
      *      we'll look for a function named "onMessageReceived" You can override
      *      this behavior by overriding getEventHandlerName in your object.
	  **/
	listenForEvent: function( event_source, event_name, use_capture, onEvent_name ) {
		if ( ! onEvent_name )
			onEvent_name = this.getEventHandlerName( event_name );
		
		if ( ! this._listens ) this._listens = new Array();
		
		//added this in to allow for anonymous function handling of an event
		var eventHandler = this[onEvent_name];
		
		if(typeof(onEvent_name) == 'function') {
			eventHandler = onEvent_name;
		}
		
		var cb = eventHandler.bindAsEventListener( this );
		this._listens.push( [ event_source, event_name, use_capture, onEvent_name, cb ] )
		
		event_source.addEventListener( event_name, cb, use_capture );
	},
	
	stopListeningForEvent: function( event_source, event_name, use_capture, onEvent_name ) {
		if ( ! this._listens ) return false;
		
		if ( ! onEvent_name )
			onEvent_name = this.getEventHandlerName( event_name );
		
		var ix_item = -1;
		var ls = this._listens.detect( function( val, ix ) {
			if ( ( val[ 0 ] == event_source )
			  && ( val[ 1 ] == event_name )
			  && ( val[ 2 ] == use_capture )
			  && ( val[ 3 ] == onEvent_name ) ) {
				ix_item = ix;
				return true;
			}
		} );
		
		if ( ix_item >= 0 ) {
			this._listens.splice( ix_item, 1 );
			
			event_source.removeEventListener( event_name, ls[ 4 ], use_capture );
			
			return true;
		}
		
		return false;
	}
} );

/**
  *  Extensions to Prototype's Event object,
  *  for cleanly creating and dispatching custom events
  *  
  *  Called from Event.Publisher
  **/
Object.extend( Event,
{
	create: function( event_data, can_bubble, cancelable, fl_dispatch, target ) {
		var event;
		
		if ( document.createEvent ) {  // gecko, safari
			if ( ! can_bubble ) can_bubble = false;
			if ( ! cancelable ) cancelable = false;
			
			if ( /Konqueror|Safari|KHTML/.test( navigator.userAgent ) ) {
				event = document.createEvent( 'HTMLEvents' )
				
				event.initEvent( 'click', can_bubble, cancelable );
			}
			else {  // gecko uses MouseEvents
				event = document.createEvent( 'MouseEvents' )
				
				event.initMouseEvent( "click", can_bubble, cancelable,
				                      window, 0, 0, 0, 0, 0,
				                      false, false, false, false, 0, null );
			}
		}
		else {  // msie
			event = document.createEventObject();
			event.event_type = 'onclick';
		}
		
		event.event_data = event_data;
		
		if ( fl_dispatch )
			Event.dispatch( target, event );
		
		return event;
	},
	
	dispatch: function( target, event ) {
		if ( document.createEvent )
			return target.dispatchEvent( event );
		else
			return target.fireEvent( ( typeof( event.event_type ) != "undefined" ) ? event.event_type : 'onclick', event );
	}
} );
// swap_views.js 
if(typeof(AC)==="undefined"){AC={}}if(typeof(document.event)==="undefined"){document.event={}}if(Event.Publisher){Object.extend(document.event,Event.Publisher)}AC.SwapView=Class.create({_view:null,currentContent:null,delegate:null,initialize:function(a){if(typeof a==="string"){this._viewId=a}else{this._view=$(a);this._resetView()}},view:function(){if(!this._view){this._view=$(this._viewId);this._resetView()}return this._view},_resetView:function(){if(!this._view){return}var b=this._view.childNodes,a;while(a=b[0]){this._view.removeChild(a)}this._view.addClassName("swapView")},setDelegate:function(a){this.delegate=a},setContent:function(a){if(a===this.currentContent){return}if(this.currentContent&&typeof(this.delegate.willClose)==="function"){this.delegate.willClose(this,this.currentContent)}if(a&&typeof(this.delegate.isContentLoaded)==="function"){if(!this.delegate.isContentLoaded(this,a)){if(typeof(this.delegate.loadContent)==="function"){this.delegate.loadContent(this,a);return}}}this.setLoadedContent(a)},setLoadedContent:function(b){if(typeof(this.delegate.willShow)==="function"){b=this.delegate.willShow(this,this.currentContent,b)}var a=true,c;if(typeof(this.delegate.shouldAnimateContentChange)==="function"){a=this.delegate.shouldAnimateContentChange(this,this.currentContent,b)}if(a&&typeof(this.delegate.willAnimate)==="function"){this.didAnimate=true;if(this.view()&&b&&this.currentContent!==b){this.view().appendChild(b)}if(typeof(this.delegate.didAppendContent)==="function"){this.delegate.didAppendContent(this,b)}c=this.delegate.willAnimate(this,this.currentContent,b,this.didShow.bind(this,b))}else{this.didAnimate=false;if(this.currentContent!==b){if(this.currentContent&&this.currentContent.parentNode){this.currentContent.parentNode.removeChild(this.currentContent)}if(b){this.view().appendChild(b)}if(typeof(this.delegate.didAppendContent)==="function"){this.delegate.didAppendContent(this,b)}}if(b){$(b).setOpacity(1)}this.didShow(b)}},didShow:function(a){if(this.currentContent&&(this.currentContent!==a)&&this.currentContent.parentNode){this.currentContent.parentNode.removeChild(this.currentContent)}if(typeof(this.delegate.didShow)==="function"){this.delegate.didShow(this,this.currentContent,a)}this.currentContent=a}});if(typeof(AC.ViewMaster)==="undefined"){AC.ViewMaster={}}AC.ViewMaster.Viewer=Class.create({view:null,triggerClassName:null,currentSection:null,requestedSection:null,sections:null,orderedSections:null,_locked:false,_didShowInitial:false,options:null,initialize:function(e,k,g,n){if(g){this.triggerClassName=g}this.sections=$H();this.orderedSections=[];this.options=n||{};this.triggerEvent=this.options.triggerEvent||"click";var d=null,l,h;if(e){for(h=0;h<e.length;h++){l=this.addSection(e.item(h));if(!d){d=l}}}this.view=new AC.SwapView(k);this.view.setDelegate(this);var a=document.location.hash,f,c;this.sectionRegExp=this.options.sectionRegExp||new RegExp(/#(.*)$/);c=a.match(this.sectionRegExp);if(c&&c[1]){a=c[1]}if(a!==this.view._viewId){var j=document.getElementsByClassName(this.triggerClassName),b;for(h=0,b;(b=j[h]);h++){if(b.getAttribute("href").match(new RegExp("#"+a+"(?![_w-])"))){f=this.sectionWithId(a);if(f){d=f}break}}}if(!f&&typeof this.options.initialId==="string"&&this.options.initialId.length>0){d=this.sectionWithId(this.options.initialId)}this.show(d);if(typeof this.triggerEvent==="object"){for(var h=0,m;m=this.triggerEvent[h];h++){Event.observe(document,m,this._triggerClicked.bindAsEventListener(this))}}else{Event.observe(document,this.triggerEvent,this._triggerClicked.bindAsEventListener(this))}if(AC.Detector.isIEStrict()){Event.observe(document,"mouseup",this._triggerClicked.bindAsEventListener(this))}if(typeof(this.listenForEvent)==="function"){this.selectSectionFromEventHandler=this.selectSectionFromEvent.bind(this);this.listenForEvent(AC.ViewMaster,"ViewMasterSelectSectionWithIdNotification",true,this.selectSectionFromEventHandler);if(this.options.parentSectionId){this.listenForEvent(AC.ViewMaster,"ViewMasterWillCloseNotification",false,function(i){var o=i.event_data.data;if(this===o.sender){return}if(o.outgoingView&&o.outgoingView.id===this.options.parentSectionId){this.willClose(this.view,this.currentSection)}})}}},initialSectionFromId:function(a){return this.sectionWithId(a)},sectionWithId:function(c){if(!c){return null}var d=null;if(c&&this.sections.get(c)){d=this.sections.get(c)}if(d){return d}var b,a=null;b=document.getElementById(c);if(b===this.view._view){b=null}if(!b){b=document.body.down("a."+this.triggerClassName+"[href*=#"+c+"]")}if(!b){a=document.getElementsByName(c);if(a&&a.length>0){b=a[0]}if(b===this.view._view){b=null}}if(b){if(b.tagName.toLowerCase()==="a"){if(Element.hasClassName(b,this.triggerClassName)){d=this.addSection(b)}}else{d=this.addSection(b)}}return d},indexOfSection:function(a){return this.orderedSections.indexOf(a.id)},selectSectionFromEvent:function(a){if(a.event_data.data.sender===this){return}if(a.event_data.data.parentTriggerClassName!==this.triggerClassName){return}this.selectSectionWithIdEvent(a.event_data.data.parentSectionId,a.event_data.data.event)},selectSectionWithIdEvent:function(f,e){var a=this.sectionWithId(f),d=null,b,c,g=false;if(a){d=a.triggers();if(d&&d.length>0){for(b=0;(c=d[b]);b++){if(Element.Methods.hasClassName(c,this.triggerClassName)){g=true;break}}}if(!g){c=document.createElement("a");c.className=this.triggerClassName;c.href="#"+f;c.style.display="none";document.body.appendChild(c);a._triggers.push(c)}this.triggerClicked(e,$(c))}},setDelegate:function(a){this.delegate=a;if(this.delegate&&typeof(this.delegate.didShow)==="function"&&this.currentSection&&this.currentSection.isContentLoaded()){this.delegate.didShow(this,this.previousSection,this.currentSection)}},createSectionForContent:function(a){return new AC.ViewMaster.Section(a,this)},addSection:function(a){var b=this.createSectionForContent(a);this.sections.set(b.id,b);this.orderedSections.push(b.id);return b},currentTrigger:function(){return this._currentTrigger},triggerClicked:function(a,b){b.addClassName("active");this._currentTrigger=b;if(a&&this.options.silentTriggers){Event.stop(a)}var d=null,e;if(!!b.href.match(/#previous/)){d=this.getPreviousSection()}else{if(!!b.href.match(/#next/)){d=this.getNextSection()}else{var c=b.href.match(this.sectionRegExp);if(c){e=c[1]}else{e=b.name}d=this.sections.get(e)}}if(!d){d=this.addSection(b)}if(d.isContentRemote()){if(d.isContentLoaded()){d.clearTrigger(b)}if(a){Event.stop(a)}}if(d===this.currentSection){if(a){Event.stop(a)}if(typeof(AC.ViewMaster.dispatchEvent)==="function"){AC.ViewMaster.dispatchEvent("ViewMasterDidShowNotification",{sender:this,outgoingView:this.previousSection,incomingView:this.currentSection,trigger:b})}return}else{if(!d){return}}this._didShowInitial=true;setTimeout(this.show.bind(this,d),1)},_triggerClicked:function(a){if(this.options.passive){return}if(this._locked){Event.stop(a);return}var c=a.element();if(AC.Detector.isIEStrict()&&a.type==="mouseup"){if(c&&c.nodeName.toUpperCase()==="A"){c=c.down("."+this.triggerClassName)}}else{while(c&&c.nodeName.toUpperCase()!=="A"&&c.nodeName.toUpperCase()!=="BODY"){c=c.parentNode}}if(c&&c.href&&Element.Methods.hasClassName(c,this.triggerClassName)){if(this.options.parentSectionId&&(typeof(this.stopListeningForEvent)==="function")&&(typeof(this.listenForEvent)==="function")&&(typeof(AC.ViewMaster.dispatchEvent)==="function")){var b=this;Event.stop(a);this.stopListeningForEvent(AC.ViewMaster,"ViewMasterSelectSectionWithIdNotification",true,this.selectSectionFromEventHandler);this.listenForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",false,function(d){this.stopListeningForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",false,arguments.callee);b.triggerClicked(d,c);this.listenForEvent(AC.ViewMaster,"ViewMasterSelectSectionWithIdNotification",true,this.selectSectionFromEventHandler)});AC.ViewMaster.dispatchEvent("ViewMasterSelectSectionWithIdNotification",{sender:this,parentSectionId:this.options.parentSectionId,parentTriggerClassName:this.options.parentTriggerClassName,event:a,trigger:c})}else{this.triggerClicked(a,c)}}},isContentLoaded:function(b,a){return a.isContentLoaded()},loadContent:function(b,a){if(a){a.loadContent()}},_showContentDidLoad:false,contentDidLoad:function(c,b,a){if(b&&b.firstChild){this._showContentDidLoad=true}this.view.setLoadedContent(c);AC.loadRemoteContent.insertScriptFragment(b);this.scrollSectionToVisible(c);if(this._showContentDidLoad&&this.delegate&&typeof(this.delegate.didShow)==="function"){this.delegate.didShow(this,this.previousSection,this.currentSection)}this._showContentDidLoad=false},show:function(c,b){if(this._locked||(!c&&!b)){return}if(!this.options.alwaysShowSection&&c===this.currentSection){return}this._locked=true;if(this.delegate&&typeof(this.delegate.willShowSection)==="function"){var a=this.delegate.willShowSection(this,this.previousSection,c);if(a instanceof AC.ViewMaster.Section){c=a}}this.previousSection=this.currentSection;this.currentSection=c;this.view.setContent(c);this.scrollSectionToVisible(c)},scrollSectionToVisible:function(a){if(typeof this.options.ensureInView==="boolean"&&this.options.ensureInView){if(this._didShowInitial){if(a._isContentLoaded){var b=a.content.viewportOffset()[1];if(b<0||b>(document.viewport.getHeight()*0.75)){new Effect.ScrollTo(a.content,{duration:0.3})}}}else{$(document.body).scrollTo()}return true}return false},showFirst:function(){this.show(this.getFirstSection())},getFirstSection:function(){return this.sections.get(this.orderedSections[0])},showNext:function(){this.show(this.getNextSection())},getNextSection:function(){var b=this.orderedSections.indexOf(this.currentSection.id);var a=(this.orderedSections.length-1)===b?0:b+1;return this.sections.get(this.orderedSections[a])},showPrevious:function(){this.show(this.getPreviousSection())},getPreviousSection:function(){var a=this.orderedSections.indexOf(this.currentSection.id);var b=0===a?this.orderedSections.length-1:a-1;return this.sections.get(this.orderedSections[b])},willShow:function(b,c,a){if(this.delegate&&typeof(this.delegate.willShow)==="function"){this.delegate.willShow(this,this.previousSection,this.currentSection)}if(typeof(AC.ViewMaster.dispatchEvent)==="function"){AC.ViewMaster.dispatchEvent("ViewMasterWillShowNotification",{sender:this,outgoingView:this.previousSection,incomingView:this.currentSection})}this._repaintTriggers(this.previousSection,this.currentSection);if(this._didShowInitial&&a&&a!=this.previousSection){$(a.content).setOpacity(0);$(a.content).removeClassName("hidden")}if(a){return a.willShow(this)}return null},willClose:function(a,b){if(this.delegate&&typeof(this.delegate.willClose)==="function"){this.delegate.willClose(this,this.previousSection,this.currentSection)}if(typeof(AC.ViewMaster.dispatchEvent)==="function"){AC.ViewMaster.dispatchEvent("ViewMasterWillCloseNotification",{sender:this,outgoingView:b})}if(this.previousSection){this.previousSection.willClose(this)}},shouldAnimateContentChange:function(d,c,b){var a=true;if(this.delegate&&typeof(this.delegate.shouldAnimateContentChange)==="function"){a=this.delegate.shouldAnimateContentChange(this,this.previousSection,this.currentSection)}else{a=(typeof this.options.shouldAnimateContentChange==="boolean")?this.options.shouldAnimateContentChange:true}return(typeof a==="boolean")?a:true},willAnimate:function(b,c,a,e){var f=this.options.animationDuration||0.4;var d=Math.random()+"Queue";if(!this._didShowInitial&&typeof(e)=="function"){e();return}if(this.delegate&&typeof this.delegate.willAnimate=="function"){return this.delegate.willAnimate(this,c,a,e,d)}if(c){return new Effect.Parallel([new Effect.Opacity(c,{sync:true,from:1,to:0}),new Effect.Opacity(a,{sync:true,from:0,to:1})],{duration:f,afterFinish:e,queue:{scope:d}})}else{return new Effect.Opacity(a,{from:0,to:1,duration:f,afterFinish:e,queue:{scope:d}})}},didAppendContent:function(a,b){if(this.delegate&&typeof this.delegate.didAppendContent==="function"){this.delegate.didAppendContent(this,b)}},didShow:function(b,c,a){if(this.currentSection){this.currentSection.didShow(this)}this._didShowInitial=true;this._locked=false;if(!this._showContentDidLoad&&this.delegate&&typeof(this.delegate.didShow)=="function"){this.delegate.didShow(this,this.previousSection,this.currentSection)}if(typeof(AC.ViewMaster.dispatchEvent)=="function"){AC.ViewMaster.dispatchEvent("ViewMasterDidShowNotification",{sender:this,outgoingView:this.previousSection,incomingView:this.currentSection,trigger:this._currentTrigger})}},_repaintTriggers:function(f,a){if(f){var e=f.triggers();for(var b=0,c;(c=e[b]);b++){c.removeClassName("active")}e=f.relatedElements();for(var b=0,c;(c=e[b]);b++){c.removeClassName("active")}}if(a){var d=a.triggers();for(var b=0,c;(c=d[b]);b++){c.addClassName("active")}d=a.relatedElements();for(var b=0,c;(c=d[b]);b++){c.addClassName("active")}}}});if(Event.Publisher){Object.extend(AC.ViewMaster,Event.Publisher)}if(Event.Listener){Object.extend(AC.ViewMaster.Viewer.prototype,Event.Listener)}AC.ViewMaster.Section=Class.create({content:null,moviePanel:null,controllerPanel:null,movie:null,_movieController:null,movieLink:null,endState:null,hasShown:false,_isContentRemote:false,isContentRemote:function(){return this._isContentRemote},_isContentLoaded:true,isContentLoaded:function(){return this._isContentLoaded},_onMoviePlayable:Prototype.EmptyFunction,_onMovieFinished:Prototype.EmptyFunction,id:null,triggers:function(){if(!this._triggers){this._triggers=[];var e=new RegExp("#"+this.id+"$");if(this.viewMaster.sectionRegExp||this.viewMaster.options.sectionRegExp){e=this.viewMaster.sectionRegExp||this.viewMaster.options.sectionRegExp;e=e.toString().replace(/^\//,"").replace(/\/$/,"");e=new RegExp(e.replace("(.*)",this.id))}var d=document.getElementsByClassName(this.viewMaster.triggerClassName);for(var b=0,c;(c=$(d[b]));b++){if(c.tagName.toLowerCase()!=="a"){continue}if(c.href.match(e)){this._triggers.push(c)}}var a=this.content.getElementsByClassName(this.viewMaster.triggerClassName);for(var b=0,c;(c=$(a[b]));b++){if(c.tagName.toLowerCase()!=="a"){continue}if(c.href.match(e)){this._triggers.push(c)}}}return this._triggers},relatedElements:function(){if(!this._relatedElements){this._relatedElements=document.getElementsByClassName(this.id)}return this._relatedElements},initialize:function(i,j){this.content=$(i);if(this.content.tagName.toLowerCase()==="a"){var c=this.content.getAttribute("href");var e=c.split("#");this._contentURL=e[0];var f=window.location.href.split("#");var d=i.className;var g=document.getElementsByTagName("base")[0];var a=g?g.href:null;if(e.length===2){this.id=e[1]}if(this._contentURL.length>0&&(!a||this._contentURL!=a)&&(this._contentURL!==f[0])&&(!this._contentURL.startsWith("#")||this._contentURL!==c)){this._isContentRemote=true;this._isContentLoaded=false}else{var h=$(this.id)||$("MASKED-"+this.id);if(h){this.content=h}}if(!this.id){this.id=this.content.name}}else{this.id=i.id}if(!this._isContentRemote||this._isContentLoaded){this.content.setAttribute("id","MASKED-"+this.id)}if(j){this.viewMaster=j}if(!this._isContentRemote&&this._isContentLoaded&&!this.content.hasClassName("content")){var b=this.content.getElementsByClassName("content")[0];if(b){this.content=b}}this.isMobile=AC.Detector.isMobile()},clearTrigger:function(a){if(a.href===("#"+this.id)){return}a.href="#"+this.id;a.removeAttribute("id");a.removeAttribute("name")},remoteContentDidLoad:function(a,b){this.clearTrigger(this.content);this.content=$(a);this.content.setAttribute("id","MASKED-"+this.id);this._isContentLoaded=true;this.viewMaster.contentDidLoad(this,b)},loadContent:function(){if(this._isContentLoaded){var b=this;b.viewMaster.contentDidLoad(b,null)}else{if(this.content.className.indexOf("imageLink")!==-1){var a=document.createElement("div");a.appendChild(this.content.cloneNode(true));this.remoteContentDidLoad(a)}else{if((this.content.className.indexOf("movieLink")!==-1)||(this.content.className.indexOf("audioLink")!==-1)){var a=document.createElement("div");a.appendChild(this.content.cloneNode(true));this.remoteContentDidLoad(a)}else{AC.loadRemoteContent(this._contentURL,true,true,this.remoteContentDidLoad.bind(this),null,this)}}}},shouldImportScriptForContentURL:function(h,g,c){var f=false;if(h.hasAttribute){f=h.hasAttribute("src")}else{src=h.getAttribute("src");f=((src!=null)&&(src!==""))}if(!f){var b=navigator.userAgent.toLowerCase(),d=(b.indexOf("applewebkit")!=-1),e=parseInt(parseFloat(b.substring(b.lastIndexOf("safari/")+7))),i=(d&&e>=419),a;if(i){a=h.innerHTML}else{a=h.text}if(a.search(/.*\.location\.replace\(.*\).*/)!==-1){return false}return true}else{return true}},mediaType:function(){return this.movieLink?"video/quicktime":"text/html"},willShow:function(){if(!this.hasShown){this.hasShown=true;var a=this.content.getElementsByClassName("imageLink");for(var b=0;b<a.length;b++){this._loadImage(a[b])}if(!this.moviePanel){this.movieLink=this.content.getElementsByClassName("movieLink")[0];this.posterLink=this.content.getElementsByClassName("posterLink")[0];if(this.movieLink){this._loadMovie()}}}return this.content},_loadImage:function(b){var a=document.createElement("img");if(b.protocol==="about:"){b.href="/"+b.pathname}a.setAttribute("src",b.href);a.setAttribute("alt",b.title);b.parentNode.replaceChild(a,b)},_loadMovie:function(){var a=this.isACMediaAvailable();this.moviePanel=$(document.createElement("div"));this.moviePanel.addClassName("moviePanel");this.movieLink.parentNode.replaceChild(this.moviePanel,this.movieLink);this.controllerPanel=$(document.createElement("div"));this.controllerPanel.addClassName("controllerPanel");if(a===false){this.moviePanel.parentNode.insertBefore(this.controllerPanel,this.moviePanel.nextSibling)}else{this.moviePanel.appendChild(this.controllerPanel)}this.endState=$(this.content.getElementsByClassName("endState")[0]);if(this.endState){this.endState.parentNode.removeChild(this.endState);var b=$(this.endState.getElementsByClassName("replay")[0]);if(b){b.observe("click",function(c){Event.stop(c);this.replayMovie()}.bindAsEventListener(this))}}},isACMediaAvailable:function(){return(typeof(Media)!="undefined")},newMovieController:function(){return new AC.QuicktimeController()},didShow:function(c){var a=this.hasMovie()&&!this.isMobile,b=this.isACMediaAvailable();if(b){if(a){this._movieControls=this._movieControls||new Media.ControlsWidget(this.controllerPanel);this._playMovie();if(this._movieController){this._movieController.setControlPanel(this._movieControls);this.onMovieFinished=this.didFinishMovie.bind(this);this._movieController.setDelegate(this)}else{this.controllerPanel.innerHTML=""}}else{this._playMovie()}}else{if(a){this._movieController=this.newMovieController();this.controllerPanel.innerHTML="";this.controllerPanel.appendChild(this._movieController.render())}this._playMovie();if(a){this._onMoviePlayable=this._movieController.monitorMovie.bind(this._movieController);this._onMovieFinished=this.didFinishMovie.bind(this);this._movieController.attachToMovie(this.movie,{onMoviePlayable:this._onMoviePlayable,onMovieFinished:this._onMovieFinished})}}},willClose:function(a){this._closeController();this._closeMovie()},_closeMovie:function(){if(this.movie&&this.moviePanel){if(!this.isACMediaAvailable()){this.moviePanel.removeChild(this.movie);this.movie=null;this.moviePanel.innerHTML=""}else{if(AC.Detector.isIEStrict()){this.moviePanel.removeChild(this.movie);this.controllerPanel.hide()}else{this.moviePanel.innerHTML=""}this.movie=null}}},_closeController:function(){if(this.isACMediaAvailable()){if(this._movieController&&this.hasMovie()&&!this.isMobile){this._movieController.stop();this._movieController.setControlPanel(null);if(AC.Detector.isIEStrict()){this.controllerPanel.hide()}this.controllerPanel.addClassName("inactive")}}else{if(this._movieController&&this._movieController.movie&&this.hasMovie()&&!this.isMobile){this._movieController.Stop();this._movieController.detachFromMovie();this.controllerPanel.addClassName("inactive");this._movieController.replay=this.replayMovie.bind(this);this.controllerPanel.observe("click",this._movieController.replay)}}},hasMovie:function(){return!!this.movieLink},didFinishMovie:function(){if(!this.hasMovie()){return}this._closeController();this._closeMovie();if(this.endState){this.moviePanel.appendChild(this.endState)}if(typeof(document.event.dispatchEvent)=="function"){document.event.dispatchEvent("didFinishMovie",this)}},defaultMovieWidth:function(){return 640},defaultMovieHeight:function(){return 480},_playMovie:function(){if(this.movieLink&&this.moviePanel){var e=this.isACMediaAvailable();if(!e){this.moviePanel.innerHTML=""}else{if(this.movie&&this.movie.parentNode==this.moviePanel){this.moviePanel.removeChild(this.movie);this.controllerPanel.hide()}if(this.endState&&this.endState.parentNode==this.moviePanel){this.moviePanel.removeChild(this.endState)}if(this.controllerPanel&&Element.hasClassName(this.controllerPanel,"inactive")){this.controllerPanel.show();Element.removeClassName(this.controllerPanel,"inactive")}}if(this.posterLink&&this.posterLink.href){var b=this.posterLink.href}var f=this.movieLink.getAttribute("href",2).toQueryParams();var d=f.width||this.defaultMovieWidth();var a=f.height||this.defaultMovieHeight();var c=f.bgcolor||"white";if(e===true){this._movieController=Media.create(this.moviePanel,this.movieLink.getAttribute("href",2),{width:d,height:a,controller:false,posterFrame:b,showlogo:false,autostart:true,cache:true,bgcolor:c,aggressiveCleanup:false});if(this._movieController){this.movie=this._movieController.video().object()}}else{this.movie=AC.Quicktime.packageMovie(this.movieLink.id+"movieId",this.movieLink.getAttribute("href",2),{width:d,height:a,controller:false,posterFrame:b,showlogo:false,autostart:true,cache:true,bgcolor:c,aggressiveCleanup:false},this.moviePanel);if(!AC.Quicktime.movieIsFlash){this.moviePanel.appendChild(this.movie)}}this.moviePanel.id="toto";if(e===true&&!this.isMobile){this._movieControls.reset();this.moviePanel.appendChild(this.controllerPanel)}if(typeof(document.event.dispatchEvent)=="function"){document.event.dispatchEvent("didStart",this)}}},replayMovie:function(){var a=this.isACMediaAvailable();if(typeof(document.event.dispatchEvent)=="function"){document.event.dispatchEvent("replayMovie",this)}if(a){if(this.moviePanel&&this.endState){this.moviePanel.removeChild(this.endState)}}this._playMovie();if(a){this.controllerPanel.show()}this.controllerPanel.removeClassName("inactive");if(a){this._movieController.setControlPanel(this._movieControls);this._movieController.setDelegate(this)}else{this.controllerPanel.stopObserving("click",this._movieController.replay);this._movieController.replay=null;this._movieController.attachToMovie(this.movie,{onMoviePlayable:this._onMoviePlayable,onMovieFinished:this._onMovieFinished})}}});AC.ViewMaster.SlideshowViewer=Class.create();Object.extend(AC.ViewMaster.SlideshowViewer.prototype,AC.ViewMaster.Viewer.prototype);Object.extend(AC.ViewMaster.SlideshowViewer.prototype,{_superInitialize:AC.ViewMaster.Viewer.prototype.initialize,initialize:function(d,a,e,c,b){this._superInitialize(d,a,e,b);this.slideshow=new AC.ViewMaster.Slideshow(this,c,b)},setDelegate:function(a){this.delegate=a},start:function(){this.slideshow.start()},stop:function(){this.slideshow.stop()},reset:function(){if(this._isLocked){this._needsReset=true}else{this.slideshow.reset()}},superDidShow:AC.ViewMaster.Viewer.prototype.didShow,didShow:function(b,c,a){this.superDidShow(b,c,a);if(this._needsReset){this._needsReset=false;this.slideshow.reset()}},next:function(){this.slideshow.next()},previous:function(){this.slideshow.previous()}});AC.ViewMaster.Slideshow=Class.create();if(Event.Listener){Object.extend(AC.ViewMaster.Slideshow.prototype,Event.Listener)}if(Event.Publisher){Object.extend(AC.ViewMaster.Slideshow.prototype,Event.Publisher)}Object.extend(AC.ViewMaster.Slideshow.prototype,{contentController:null,animationTimeout:null,options:null,_playing:false,_active:false,_progress:0,setProgress:function(a){this._progress=a},progress:function(){return this._progress},initialize:function(a,c,b){this.contentController=a;this.triggerClassName=c;this.options=b||{};if(!this.options.addNoListeners){this.listenForEvent(AC.ViewMaster,"ViewMasterWillShowNotification",true,this.willShow);this.listenForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",true,this.didShow)}if(this.options.autoplay){this.start()}if(this.triggerClassName){Event.observe(document,"click",this._triggerHandler.bindAsEventListener(this))}},start:function(){if(this._active){return}this._active=true;if(this.options.wipeProgress=="always"||this.options.wipeProgress=="on start"){this._progress=0}this.play(true);this._repaintTriggers();if(typeof(document.event.dispatchEvent)=="function"){document.event.dispatchEvent("didStart",this)}},stop:function(){if(!this._active){return}this._active=false;this.pause();this._repaintTriggers();if(typeof(document.event.dispatchEvent)=="function"){document.event.dispatchEvent("didEnd",this)}},play:function(a){if(!this._active){return}if(this.options.wipeProgress=="always"||(this.options.wipeProgress=="on play"&&!a)){this._progress=0}this.animationTimeout=setTimeout(this._update.bind(this),this._heartbeatDelay());this._playing=true},_update:function(){if(typeof(this.options.onProgress)=="function"){this.options.onProgress(this._progress,this.delay())}if(this._progress>=this.delay()){this._progress=0;this.next()}else{this._progress+=this._heartbeatDelay();this.animationTimeout=setTimeout(this._update.bind(this),this._heartbeatDelay())}},delay:function(){return this.options.delay||5000},_heartbeatDelay:function(){return this.options.heartbeatDelay||100},pause:function(){clearTimeout(this.animationTimeout);this._playing=false},next:function(){if(this.options.willEnd&&(this.contentController.getNextSection()==this.contentController.getFirstSection())){if(typeof(document.event.dispatchEvent)=="function"){document.event.dispatchEvent("didEnd",this)}return}this.contentController.showNext()},previous:function(){this.contentController.showPrevious()},reset:function(){this.contentController.showFirst();this.setProgress(0)},willShow:function(a){if(a.event_data.data.sender!=this.contentController){return}this.pause()},didShow:function(a){if(a.event_data.data.sender!=this.contentController){return}this.play()},_triggerHandler:function(a){var b=a.element();var c=null;if(b.hasClassName(this.triggerClassName)&&b.href.match(/#slideshow-toggle/)){Event.stop(a);if(this._active){this.stop()}else{this.start()}}},_repaintTriggers:function(){if(!this.triggerClassName){return}var b=document.getElementsByClassName(this.triggerClassName);for(var a=b.length-1;a>=0;a--){this._repaintTrigger(b[a])}},_repaintTrigger:function(a){var b=$(a);if(this._active){b.addClassName("playing")}else{b.removeClassName("playing")}}});AC.loadRemoteContent=function(h,a,c,g,d,f){if(typeof h!=="string"){return}if(typeof a!=="boolean"){a=true}if(typeof c!=="boolean"){c=true}var e=arguments.callee;var b=e._loadArgumentsByUrl[h];if(!b){e._loadArgumentsByUrl[h]={contentURL:h,importScripts:a,importCSS:c,callback:g,context:d,delegate:f};new Ajax.Request(h,{method:"get",requestHeaders:{Accept:"text/xml"},onSuccess:arguments.callee.loadTemplateHTMLFromRequest,onFailure:arguments.callee.failedToadTemplateHTMLFromRequest,onException:function(i,j){throw(j)},onCreate:function(i){i.request.overrideMimeType("text/xml")}})}};AC.loadRemoteContent._loadArgumentsByUrl={};AC.loadRemoteContent.loadTemplateHTMLFromRequest=function(b){var d=b.request.url;var m=arguments.callee;var h=AC.loadRemoteContent._loadArgumentsByUrl[d];var q=window.document;var k=b.responseXMLValue().documentElement;if(AC.Detector.isIEStrict()){k=k.ownerDocument}var q=window.document;var l=document.createDocumentFragment();if(h.importScripts){AC.loadRemoteContent.importScriptsFromXMLDocument(k,l,h)}if(h.importCSS){AC.loadRemoteContent.importCssFromXMLDocumentAtLocation(k,d,h)}var r=null;var a=null;var g=k.getElementsByTagName("body")[0];if(!g){return}g.normalize();var a=Element.Methods.childNodeWithNodeTypeAtIndex(g,Node.ELEMENT_NODE,0);var f=AC.Detector.isSafari2();if(a){if(f){r=q._importNode(a,true)}else{r=q.importNode(a,true)}if(r.cleanSpaces){r.cleanSpaces(true)}}else{if(g.cleanSpaces){g.cleanSpaces(true)}else{if(typeof g.normalize==="function"){g.normalize()}}var j=g.childNodes;r=q.createDocumentFragment();var n=/\S/;for(var e=0,c=0;(c=j[e]);e++){var o=(f)?q._importNode(c,true):q.importNode(c,true);r.appendChild(o)}}var p=h.callback;p(r,l,h.context)};AC.loadRemoteContent.javascriptTypeValueRegExp=new RegExp("text/javascript","i");AC.loadRemoteContent.javascriptLanguageValueRegExp=new RegExp("javascript","i");AC.loadRemoteContent.documentScriptsBySrc=function(){if(!AC.loadRemoteContent._documentScriptsBySrc){AC.loadRemoteContent._documentScriptsBySrc={};var b=document.getElementsByTagName("script");if(!b||b.length===0){return AC.loadRemoteContent._documentScriptsBySrc}for(var c=0,a=null;(a=b[c]);c++){var d=a.getAttribute("type");var f=null;var g=a.getAttribute("language");if(!this.javascriptTypeValueRegExp.test(d)&&!this.javascriptLanguageValueRegExp.test(g)){continue}if(a.hasAttribute){var e=a.hasAttribute("src")}else{var e=Element.Methods.hasAttribute(a,"src")}if(e){var f=a.getAttribute("src");AC.loadRemoteContent._documentScriptsBySrc[f]=f}}}return AC.loadRemoteContent._documentScriptsBySrc};AC.loadRemoteContent.importScriptsFromXMLDocument=function(o,c,v){var f=o.getElementsByTagName("script"),g,j,q,w,d=v.contentURL,u=v.delegate,e=v.context,b=(u&&typeof u.shouldImportScriptForContentURL==="function"),k=true;if(!c){c=document.createDocumentFragment()}var m=AC.loadRemoteContent.documentScriptsBySrc();for(var s=0,n=null;(n=f[s]);s++){g=n.getAttribute("type");j=null;k=true;q=n.getAttribute("language");if(!this.javascriptTypeValueRegExp.test(g)&&!this.javascriptLanguageValueRegExp.test(q)){continue}if(n.hasAttribute){w=n.hasAttribute("src");j=n.getAttribute("src")}else{j=n.getAttribute("src");w=((j!=null)&&(j!==""))}if(n.getAttribute("id")==="Redirect"||(b&&!u.shouldImportScriptForContentURL(n,d,e))){continue}if(w){if(!m.hasOwnProperty(j)){var p=document.createElement("script");p.setAttribute("type","text/javascript");if(AC.Detector.isIEStrict()){p.tmp_src=j;p.onreadystatechange=function(){var i=window.event.srcElement,x;if(!i.isLoaded&&((i.readyState=="complete")||(i.readyState=="loaded"))){x=i.tmp_src;if(x){i.tmp_src=null;i.src=x;i.isLoaded=false}else{i.onreadystatechange=null;i.isLoaded=true}}}}else{p.src=j}AC.loadRemoteContent._documentScriptsBySrc[j]=j;c.appendChild(p)}}else{var p=document.createElement("script");p.setAttribute("type","text/javascript");if(AC.Detector.isIEStrict()){var l=new Function(n.text);p.onreadystatechange=function(){var i=window.event.srcElement;if(!i.isLoaded&&((i.readyState=="complete")||(i.readyState=="loaded"))){i.onreadystatechange=null;i.isLoaded=true;l()}}}else{var r=navigator.userAgent.toLowerCase();var a=(r.indexOf("applewebkit")!=-1);var h=parseInt(parseFloat(r.substring(r.lastIndexOf("safari/")+7)));var t=(a&&h>=419);if(t){p.innerHTML=n.innerHTML}else{p.text=n.text}}AC.loadRemoteContent._documentScriptsBySrc[j]=j;c.appendChild(p)}}return c};AC.loadRemoteContent.insertScriptFragment=function(e){if(!e){return}AC.isDomReady=false;Event._domReady.done=false;var d=document.getElementsByTagName("head")[0],g=e.childNodes,b,c,a=function(){var h;if(!window.event||((h=window.event.srcElement)&&(h.isLoaded||((typeof h.isLoaded==="undefined")&&((h.readyState=="complete")||(h.readyState=="loaded")))))){arguments.callee.loadedCount++;if(h&&!h.isLoaded){h.onreadystatechange=null;h.isLoaded=true}if(arguments.callee.loadedCount===arguments.callee.loadingCount){Event._domReady()}}};a.loadedCount=0;a.loadingCount=e.childNodes.length;for(c=0;(b=g[c]);c++){if(b.addEventListener){b.addEventListener("load",a,false)}else{if(typeof b.onreadystatechange==="function"){var f=b.onreadystatechange;b.onreadystatechange=function(h){var i=window.event.srcElement;f.call(i);a()}}else{b.onreadystatechange=a}}}d.appendChild(e);d=null};AC.loadRemoteContent.documentLinksByHref=function(){if(!AC.loadRemoteContent._documentLinksByHref){AC.loadRemoteContent._documentLinksByHref={};var b=document.getElementsByTagName("link");if(!b||b.length===0){return AC.loadRemoteContent._documentLinksByHref}for(var c=0,e=null;(e=b[c]);c++){var d=e.getAttribute("type");if(e.type.toLowerCase()!=="text/css"){continue}var f=null;if(e.hasAttribute){var a=e.hasAttribute("href")}else{var a=Element.hasAttribute(e,"href")}if(a){var f=e.getAttribute("href");AC.loadRemoteContent._documentLinksByHref[f]=f}}}return AC.loadRemoteContent._documentLinksByHref};AC.loadRemoteContent.__importCssElementInHeadFromLocation=function(e,g,b){var d=(e.tagName.toUpperCase()==="LINK");if(d){var f=e.getAttribute("type");if(!f||f&&f.toLowerCase()!=="text/css"){return}var c=e.getAttribute("href");if(!c.startsWith("http")&&!c.startsWith("/")){var i=c;if(b.pathExtension().length>0){b=b.stringByDeletingLastPathComponent()}c=b.stringByAppendingPathComponent(i)}if(AC.Detector.isIEStrict()){var a=window.document.createStyleSheet(c,1)}else{var h=window.document.importNode(e,true);h.href=c}AC.loadRemoteContent.documentLinksByHref()[c]=c}if(!AC.Detector.isIEStrict()||(AC.Detector.isIEStrict()&&!d)){g.insertBefore(h,g.firstChild)}};AC.loadRemoteContent.importCssFromXMLDocumentAtLocation=function(h,b,g){var j=window.document.getElementsByTagName("head")[0];var c=[];c.addObjectsFromArray(h.getElementsByTagName("style"));c.addObjectsFromArray(h.getElementsByTagName("link"));if(c){var d=AC.loadRemoteContent.documentLinksByHref();for(var e=0,f=null;(f=c[e]);e++){var a=f.getAttribute("href");if(d.hasOwnProperty(a)){continue}this.__importCssElementInHeadFromLocation(f,j,b)}}};Ajax.Request.prototype._overrideMimeType=null;Ajax.Request.prototype.overrideMimeType=function(a){this._overrideMimeType=a;if(this.transport.overrideMimeType){this.transport.overrideMimeType(a)}};Ajax.Request.prototype._doesOverrideXMLMimeType=function(){return(this._overrideMimeType==="text/xml")};Ajax.Response.prototype.responseXMLValue=function(){if(AC.Detector.isIEStrict()){var a=this.transport.responseXML.documentElement;if(!a&&this.request._doesOverrideXMLMimeType()){this.transport.responseXML.loadXML(this.transport.responseText)}}return this.transport.responseXML};
// overlay_panel.js
AC.OverlayPanel=Class.create();Object.extend(AC.OverlayPanel.prototype,AC.ViewMaster.Viewer.prototype);Object.extend(AC.OverlayPanel.prototype,Event.Listener);Object.extend(AC.OverlayPanel.prototype,Event.Publisher);Object.extend(AC.OverlayPanel.prototype,{closeBtn:null,overlay:null,overlayShadow:null,overlayId:"",overlayClasses:"",overlayContents:"",overlayShadowId:"",overlayShadowClasses:"",_overlayShadowSrc:null,_defaultOverlayShadowSrc:"files/lightbox_files/background.png",defaultOverlayShadowSrc:function(){var b=document.getElementsByTagName("base")[0],c=b?b.href:"",a=this._defaultOverlayShadowSrc;if(!c||(c&&c.lastIndexOf("/")!==(c.length-1))){a="/"+a}return c+a},order:0,setOverlayShadowImageSrc:function(a){this._overlayShadowSrc=(a)?a:this.defaultOverlayShadowSrc();this.overlayshadowImage.src=this._overlayShadowSrc;if(this.isIE7()){this.overlayshadowImage.runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this._overlayShadowSrc+"',sizingMethod='scale')";this.overlayshadowImage.src="http://images.apple.com/global/elements/blank.gif"}},overlayShadowImageSrc:function(){return(this._overlayShadowSrc)?this._overlayShadowSrc:this.defaultOverlayShadowSrc()},initialize:function(c,a,d,b){this.overlayId="OverlayPanel";this.overlayShadowId="OverlayPanelShadow";this.createOverlay();d=d||"OverlayPanel";AC.ViewMaster.Viewer.prototype.initialize.call(this,null,this.swapViewElement,d,b);this.options.shouldAnimateContentChange=false},createOverlay:function(){this.closeBtnContainer=document.createElement("div");this.closeBtnContainer.className="closeButtonContainer";this.closeBtn=document.createElement("a");this.closeBtn.href="#close";this.closeBtn.className="close";this.closeBtn.appendChild(document.createTextNode("Close"));this.closeBtnContainer.appendChild(this.closeBtn);Event.observe(this.closeBtn,"click",this.close.bindAsEventListener(this),false);this.swapViewElement=Builder.node("div",{"class":"overlayPanelContent"});this.overlayshadowImage=Builder.node("img",{src:this.overlayShadowImageSrc(),alt:"",border:0,"class":"overlayPanelShadowImage"});if(this.isIE7()){this.overlayshadowImage.runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this.overlayShadowImageSrc()+"',sizingMethod='scale')";this.overlayshadowImage.src="http://images.apple.com/global/elements/blank.gif"}this.overlayshadow=Builder.node("div",{id:this.overlayShadowId,"class":"overlaypanelshadow "+this.overlayShadowClasses},[this.overlayshadowImage,this.swapViewElement]);this.overlay=$(Builder.node("div",{id:this.overlayId,"class":"overlaypanel "+this.overlayClasses,style:"left:-99999px; top:0;"},[this.closeBtnContainer,this.overlayshadowImage,this.swapViewElement]))},isIE7:function(){return(AC.Detector.isIEStrict()&&navigator.appVersion.indexOf("MSIE 6.0")>=0)},setDefaults:function(){this.defaultWidth=this.overlay.offsetWidth;this.padleft=parseInt(Element.getStyle(this.overlay,"marginLeft").replace(/px/i,""));this.padright=parseInt(Element.getStyle(this.overlay,"marginRight").replace(/px/i,""));this.defaultHeight=this.overlay.offsetHeight;this.padtop=parseInt(Element.getStyle(this.overlay,"marginTop").replace(/px/,""));this.padbottom=parseInt(Element.getStyle(this.overlay,"marginBottom").replace(/px/,""))},setItemAttributes:function(){},registerOverlay:function(){Event.observe(document,"click",this.onClick.bindAsEventListener(this),false)},isContentLoaded:function(b,a){return false},superContentDidLoad:AC.ViewMaster.Viewer.prototype.contentDidLoad,contentDidLoad:function(c,b){document.body.appendChild(this.overlay);this.superContentDidLoad(c,b);c.content.show();c.content.style.visibility="hidden";c.content.removeClassName("overlaydescription");this.overlay.addClassName(c.id);this.setOriginFromEvent(this.currentSectionEvent);this.setDefaults();var a=this;this._isDisplaying=true;setTimeout(function(){a._display(c)},100)},_isDisplaying:false,_display:function(b){this.setDefaults();this.setDimensions(this.currentSectionEvent,b.content);var a=this;return this.pop(this.defaultWidth,this.popPosition().top,this.defaultHeight,this.popPosition().left)},superWillShow:AC.ViewMaster.Viewer.prototype.willShow,willShow:function(b,c,a){return this.superWillShow(b,c,a)},superTriggerClicked:AC.ViewMaster.Viewer.prototype.triggerClicked,triggerClicked:function(a,b){if(a){Event.stop(a)}this.superTriggerClicked(a,b);if(this._isDisplaying){return}this.setOverlayShadowImageSrc(null);this._popPosition=null;this.currentSectionEvent=a},superShouldAnimateContentChange:AC.ViewMaster.Viewer.prototype.shouldAnimateContentChange,shouldAnimateContentChange:function(c,b,a){if(AC.Detector.isiPhone()){return false}return this.superShouldAnimateContentChange(c,b,a)},willAnimate:function(b,c,a,d){},setOriginFromEvent:function(a){if(!a){return}this.left=a.pageX||a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft);this.top=a.pageY||a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)},setDimensions:function(b,c){this._width=(c.offsetWidth>80)?80:c.offsetWidth;this.defaultWidth=c.offsetWidth;var a=null;if(b){a=Element.cumulativeOffset(b.element())}if(a){this.left=a.left}this.left=this.left||document.body.getDimensions().width/2;this.defaultHeight=c.offsetHeight;this._height=Math.round((this._width*this.defaultHeight)/this.defaultWidth);if(a){this.top=a.top}this.top=this.top||document.body.getDimensions().height/2;this.padleft=parseInt(Element.getStyle(c,"marginLeft").replace(/px/i,""));this.padright=parseInt(Element.getStyle(c,"marginRight").replace(/px/i,""));this.padtop=parseInt(Element.getStyle(c,"marginTop").replace(/px/,""));this.padbottom=parseInt(Element.getStyle(c,"marginBottom").replace(/px/,""))},windowSize:function(){var c=document.clientWidth||(document.documentElement.clientWidth||document.body.clientWidth);var b=document.clientHeight||(document.documentElement.clientHeight||document.body.clientHeight);var a=window.pageXOffset||(window.document.documentElement.scrollLeft||window.document.body.scrollLeft);var d=window.pageYOffset||(window.document.documentElement.scrollTop||window.document.body.scrollTop);if(AC.Detector.isiPhone()){c=parseInt(980);b=parseInt(1212)}return{width:c,height:b,x:a,y:d}},popPosition:function(){if(!this._popPosition){var c,b=null;var a=this.windowSize();c=a.x+(a.width-this.defaultWidth-this.padleft-this.padright)/2;if(a.width<this.defaultWidth+this.padleft+this.padright){c=a.x-(this.padtop-this.closeBtnContainer.offsetWidth)}b=(a.y+(a.height-this.defaultHeight-this.padtop-this.padbottom)/2);if(a.height<this.defaultHeight+this.padtop+this.padbottom){b=a.y-(this.padtop-this.closeBtnContainer.offsetHeight)}if(b<0||b<20){b=20}this._popPosition={left:c,top:b}}return this._popPosition},setWidth:function(a){this.defaultWidth=a;this.overlay.style.width=a+"px"},width:function(){return this.defaultWidth},setHeight:function(a){this.defaultHeight=a;this.overlay.style.height=a+"px"},height:function(){return this.defaultHeight},prepPop:function(){},beforePop:function(){Element.addClassName(this.overlay,"isanim");Element.addClassName(this.overlayshadow,"isanim");Element.addClassName(this.overlay,"popped");Element.addClassName(this.overlayshadow,"popped");if(AC.Detector.isIEStrict()){}},pop:function(b,f,a,e,d){Element.setOpacity(this.overlay,0);Element.setOpacity(this.overlayshadow,0);this._height=this._width*a/b;this.overlay.style.width=this._width+"px";this.overlay.style.height=this._height+"px";this.overlay.style.left=this.left-this.padleft+"px";this.overlay.style.top=this.top-this.padtop+"px";this.overlay.style.display="";var c=(100*b)/this._width;new Effect.Parallel([new Effect.MoveBy(this.overlay,f-this.top+this.padtop,e-this.left+this.padleft,{sync:true}),new Effect.Scale(this.overlay,c,{sync:true,scaleContent:false}),new Effect.Appear(this.overlay,{sync:true})],{duration:0.3,beforeStart:this.beforePop.bind(this),afterFinish:this.afterPop.bind(this)})},afterPop:function(b,a){this.closeBtnContainer.style.display="block";this.currentSection.content.style.visibility="visible";this.setPoppedClass()},superWillClose:AC.ViewMaster.Viewer.prototype.willClose,willClose:function(){this.dispatchEvent("beforeClose",this);this.superWillClose(this,this.currentSection);if(this.currentSection){this.currentSection.willClose()}},resetOverlay:function(){this.overlay.style.width="";this.overlay.style.height="";this.overlay.setOpacity("")},setPoppedClass:function(){Element.removeClassName(this.overlay,"isanim");Element.removeClassName(this.overlayshadow,"isanim");Element.addClassName(this.overlay,"popped");Element.addClassName(this.overlayshadow,"popped")},setIsanimClass:function(){Element.addClassName(this.overlay,"isanim");Element.addClassName(this.overlayshadow,"isanim");Element.removeClassName(this.overlay,"popped");Element.removeClassName(this.overlayshadow,"popped")},close:function(b){if(b){Event.stop(b)}var c=this.defaultWidth;var e=this.overlay.offsetLeft;var a=this.defaultHeight;var d=this.overlay.offsetTop;if(e>=0&&d>=0){this.willClose(this);setTimeout(this._closeOpenOverlay.bind(this,c,e,a,d),10)}},_closeOpenOverlay:function(b,e,a,d){if(!AC.Detector.isiPhone()){var c=(100*this._width)/b;new Effect.Parallel([new Effect.MoveBy(this.overlay,this.top-this.padtop-d,this.left-this.padleft-e,{sync:true}),new Effect.Scale(this.overlay,c,{sync:true,scaleContent:false}),new Effect.Fade(this.overlay,{sync:true})],{duration:0.3,afterFinish:this.afterClose.bind(this)})}else{this.afterClose()}},afterClose:function(){Element.removeClassName(this.overlay,"isanim");Element.removeClassName(this.overlayshadow,"isanim");Element.removeClassName(this.overlay,"popped");Element.removeClassName(this.overlayshadow,"popped");this.overlay.removeClassName(this.currentSection.id);this.setOverlayShadowImageSrc(null);this.overlay.style.width="";this.overlayshadow.style.width="";this.overlay.style.height="";this.overlayshadow.style.height="";this.overlay.style.left="-99999px";this.overlayshadow.style.left="";this.overlay.style.top="0";this.overlayshadow.style.top="";this.overlay.style.display="";this.overlayshadow.style.display="";this.dispatchEvent("afterClose",this);if(AC.Detector.isWebKit()){this.fixSafarisScrollBars()}this.show(null,true);document.body.removeChild(this.overlay);this._isDisplaying=false},fixSafarisScrollBars:function(){var a=1;var b=this.windowSize();window.scroll(b.x+a,b.y+a);window.scroll(b.x,b.y)}});Event.onDOMReady(function(){AC.OverlayPanel.overlay=new AC.OverlayPanel()});
